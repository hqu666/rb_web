<!doctype html>
<html lang="jp">
	<head>
	  <meta charset="UTF-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Recovery Brain web</title>
		<!--<title>Socket.IO から nodes直下; whiteboard</title>-->
		<link rel="stylesheet" href="style.css">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Cache-Control" content="no-cache">
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.js"></script>
	    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

		<!-- <link type="text/css" rel="stylesheet"
		  href="http://code.jquery.com/ui/1.10.3/themes/cupertino/jquery-ui.min.css" />
		<script type="text/javascript"
		  src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
		<script type="text/javascript"
		  src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script> -->

	</head>
	<body style="overflow: hidden;">
		<div class="modal fade" id="modal_box">
		 	<div class="modal-dialog">
		   		<div class="modal-content">
					<div class="box_inner">
						 <div class="modal-header">
							 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							  <i class="glyphicon glyphicon-remove"></i>
							</button>
							<div　class="modal-title" id="modalTitol">
								タイトル
							</div>
						</div>
						<div class="modal-body">
							<div id="modalComent">
								コメント
							</div>
							<div id="modalImgList">
								<img  src="/stereotype/st001.png" width="20%" height="20%">
								<img src="/stereotype/st002.png" width="20%" height="20%">
								<img  src="/stereotype/st003.png" width="20%" height="20%">
								<img  src="/stereotype/st004.png" width="20%" height="20%">
							</div>



							<div id="progressBase"  class="progress" style="margin: 5px;">
				  				<div id="progressBs" class="progress-bar" role="progressbar" style="width: 0%;">
				  					  0%
				  				</div>
			  			  	</div>
						</div>
						 <div class="modal-footer">
							 <!-- <button class="btn btn-default" data-dismiss="modal">
					            data-dismiss="modal"
					         </button>
					         <button class="btn btn-danger" data-bind="click: close">
					           data-bind="click: close"
					         </button>
					         <button class="btn btn-default" data-dismiss="modal">
					           data-dismiss="modal"
					         </button>
						 </div> -->
					</div>
				</div>
			</div>
		</div>

		<div id="container">
			<div id="header">
				<div class="row" id="urlInfoAria">
					<div class="col-sm-10" id="urlDescriptionAria">
						RECOVERY DOOR社のリカバリーブラインをアプリケーション化しました。<br>
						こちら側の画面に表示される線や図形を、操作側の画面からなぞり、一致した度合いでスコアを表示します。<br>
						操作側のブラウザにセットするURL≫  <span id="infoAria" style="border-color: blue;border-bottom-color: aqua;color: crimson;"></span>
						 >>スマホはQRコードで接続して下さい。<br>
						 トレース元図形を確定にするとスコアの評価が始まります。
						 <input type="button" id="dlog_bt" value="モーダル表示確認" style="height: 24px;border-radius: 4px;margin-left: 50px;">
					 <!-- <div class="click_btn" id="dlog_bt" style="">
							 ここをClickするとモーダルが出る
						</div> -->
						<div id="scoreAria">
							  トレース元図形
							<select id="jobSelect" size="1">
								<option value="make">作成</option>
								<!-- <option value="fileSel">ファイルから読み込み</option> -->
								<option value="patranList">パターンリスト表示</option>
								<option value="comp">確定</option>
							</select>
							<div id="scoreBrock" style="display: inline-block;margin-left: 50px;margin-right: 50px">
								スコア
								<span id="scoreTF"  style="font-size: x-large">
									100
								</span>点
								<span id="compTF" style="margin-left: 50px">
									0
								</span>/
								<span id="orgTF">
									0
								</span>残り
								<input type="button" id="useComp" value="判定" style="width: 62px;height: 24px;border-radius: 4px;margin-left: 50px;">
							</div>
							<div id="editerAria">
								<select id="typeSelect" size="1">
									<option value="free">フリーハンド</option>
									<option value="text">テキスト</option>
									<option value="line">直線</option>
									<option value="stamp">図形スタンプ</option>
									<option value="erasre">消しゴム</option>
								</select>
								<input type="color" id="colorPalet">
								<span id="graficOptions">
									線の太さ
									<select id="lineWidthSelect" size="1">
										<option value="1"> 1pt</option>
										<option value="5"> 5pt</option>
										<option value="10">10pt</option>
										<option value="20">20pt</option>
										<option value="50">50pt</option>
									</select>
									先端
									<select id="lineCapSelect" size="1">
										<option value="round">丸</option>
										<option value="square">四角</option>
										<option value="butt">無し</option>
									</select>
								</span>
								<span id="texeOptions">
									文字サイズ
									<select id="fontSizeSelect" size="1">
										<option value="6"> 6pt</option>
										<option value="12">12pt</option>
										<option value="24">24pt</option>
										<option value="48">48pt</option>
									</select>
								</span>
								<input type="button" id="allclear" value="消去" style="width: 62px;height: 24px;border-radius: 4px;margin-left: 50px;">
								<input type="button" id="orgComp" value="確定" style="width: 62px;height: 24px;border-radius: 4px;margin-left: 50px;">
							</div>
						</div>
					</div>
					<div class="col-sm-2" id="urlQR" style="text-align: right;padding-right: 20px;border: crimson;border-width: thin;">
					</div>
				</div>
				<!-- <div class="progress" id="progressFleam" style="margin: 5px;">
					<div id="progressBs" class="progress-bar" role="progressbar" style="width: 0%;">
						  20%
					</div>
				</div> -->
			</div>
			<!-- <div class="row" >
				<div id="progress">
				  <div id="loading"></div>
				</div>
				<div id="spinner" style="display:none;"><img src="loader _cycle_r.gif" /></div>
			</div> -->
			<div id="contents">
				<canvas class="whiteboard" id="hitarea"></canvas>
			</div>

			<div id="footer">
			<span id="eventComent" style="text-align: right;margin-left:  50px;"></span>
			</div>
	</div>
	<script src="/socket.io/socket.io.js"></script>
	<script src="/repi_brain.js"></script>
    <script src="jquery.qrcode.min.js"></script>

	<script type="text/javascript">
		window.onload = function(){	// onload	;	ページ読み込み時に実行したい処理
			var dbmsg = "[onload]";
			var protocol = location.protocol
			dbmsg += "　,protocol="+protocol;		//protocol=http:
			var urlStr = location.href +"";
			dbmsg += ",urlStr=　"+urlStr;				//protocol + hostname + port + hash をまとめて首都kぅ
			var host = location.hostname ;			//プロトコル情報を除外したURLを取得する(port情報なし)>>
			dbmsg += "　,host="+host;						//host=127.0.0.1
			var path = location.pathname ;				//URLでパスの部分を取得・設定する
			dbmsg += "　,path="+path;							//path=/　,query=
			var port = location.port;					//":3080/" ;
			dbmsg += "　,port="+port;							//path=/　,query=
			var search = location.search ;
			dbmsg += "　,search="+search;
			var query = location.query ;
			dbmsg += "　,query="+query;
			var hash = location.hash ;					//location.hash	URL内のハッシュ情報を抽出して取得する
			dbmsg += "　,hash="+hash;
			// var ipAddress = '<?php echo $_SERVER['REMOTE_ADDR']; ?>';
			// dbmsg += "　,ipAddress="+ipAddress;
			var	tframe = document.getElementById("tframe");
			var	titolAncar = document.getElementById("titolAncar");

			// var targetUrl = urlStr.replace( path, ":3080" );
			// dbmsg += "　,targetUrl="+targetUrl;			//targetUrl=http::3080/127.0.0.1:3080/　
			var reciverPostion =urlStr.indexOf('reciver');
			dbmsg += "　,reciverPostion="+reciverPostion + "/" + urlStr.length;
			if(-1 == urlStr.indexOf('sesion')){
				var now = new Date();
				var UrlPparam =  "?sesion=" +  now.getYear() +(now.getMonth()+1)+now.getDate()+now.getHours()+now.getMinutes()+now.getSeconds();		// "?sesion="
				dbmsg += "　,UrlPparam="+UrlPparam;			//,UrlPparam=?sesion=11872218750　,wifiURL=http://192.168.3.10　//QR=http://http://192.168.3.10:3080/?sesion=11872218750?reciver="pad"
				urlStr += UrlPparam;	//		urlStr =protocol+"//"+ host+UrlPparam + port + '?reciver=pad';
				location.href=urlStr;
			}
			if(-1 <reciverPostion){
				urlStr = urlStr.substring(0,reciverPostion-1);
				dbmsg += ">urlStr>"+urlStr;
				document.getElementById("urlInfoAria").style.display="none";				// $("#urlInfoAria").では使えない
				//課題　；非表示にした分、描画範囲修正（上端）
				// current.color= '#FF0000';						//課題；Canvaceを取得してカラー設定
			}else{
				urlStr +='?reciver=pad';
				var infoAria = document.getElementById("infoAria");
					infoAria.innerHTML = '<a href="' + urlStr + '"  target="_blank">' + urlStr + '</a>';

					// applican.wifi.getCurrentIPv4Address(getCurrentIPv4Address_Success, getCurrentIPv4Address_Error);
					// var ipAddress = '<?php echo $_SERVER['REMOTE_ADDR']; ?>';
					// dbmsg += "　,ipAddress="+ipAddress;
					var wifiURL = '192.168.100.6';		//課題；取得方法；Javascriptでは取得できない
					// var wifiURL = '192.168.3.10';		//自宅
					dbmsg += "　,wifiURL="+wifiURL;
					if(-1 < urlStr.indexOf('127.0.0.1')){						//xamppでのテスト
						urlStr = urlStr.replace('127.0.0.1', wifiURL);				//'http://192.168.3.10:3080'
					}
					dbmsg += "　,QR="+urlStr;
					$("#urlQR").html("");
		        	$("#urlQR").qrcode({width:100,//横幅
									    height:100,//高さ
										text:urlStr});
			}
			document.getElementById("scoreBrock").style.display="none";
			// document.getElementById("useComp").style.display="none";
			document.getElementById("editerAria").style.display="inline-block";			 // 編集ツール表示
			document.getElementById("dlog_bt").style.display="none";
			document.getElementById("allclear").click();								//リロード時の消去
			console.log(dbmsg);
		}
	</script>
	</body>
</html>


<!--
https://github.com/socketio/socket.io/tree/master/examples/whiteboard
-->
